<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.547">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Real time linkage</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="real_time_record_linkage_files/libs/clipboard/clipboard.min.js"></script>
<script src="real_time_record_linkage_files/libs/quarto-html/quarto.js"></script>
<script src="real_time_record_linkage_files/libs/quarto-html/popper.min.js"></script>
<script src="real_time_record_linkage_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="real_time_record_linkage_files/libs/quarto-html/anchor.min.js"></script>
<link href="real_time_record_linkage_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="real_time_record_linkage_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="real_time_record_linkage_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="real_time_record_linkage_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="real_time_record_linkage_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Real time linkage</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this notebook, we demonstrate splink’s incremental and real time linkage capabilities - specifically: - the <code>linker.compare_two_records</code> function, that allows you to interactively explore the results of a linkage model; and - the <code>linker.find_matches_to_new_records</code> that allows you to incrementally find matches to a small number of new records</p>
<section id="step-1-load-a-pre-trained-linkage-model" class="level3">
<h3 class="anchored" data-anchor-id="step-1-load-a-pre-trained-linkage-model">Step 1: Load a pre-trained linkage model</h3>
<div id="987b6789" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> splink.datasets <span class="im">import</span> splink_datasets</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> splink.duckdb.linker <span class="im">import</span> DuckDBLinker</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>alt.renderers.enable(<span class="st">'html'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"real_time_settings.json"</span>) <span class="im">as</span> f:</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    trained_settings <span class="op">=</span> json.load(f)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> splink_datasets.fake_1000</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>linker <span class="op">=</span> DuckDBLinker(df, trained_settings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c89da724" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>linker.waterfall_chart(linker.predict().as_record_dict(limit<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<style>
  #altair-viz-0cfe7fac84c54d179d007d5de3bde795.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-0cfe7fac84c54d179d007d5de3bde795.vega-embed details,
  #altair-viz-0cfe7fac84c54d179d007d5de3bde795.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0cfe7fac84c54d179d007d5de3bde795"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0cfe7fac84c54d179d007d5de3bde795") {
      outputDiv = document.getElementById("altair-viz-0cfe7fac84c54d179d007d5de3bde795");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.16.3?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.16.3"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"layer": [{"mark": "rule", "encoding": {"color": {"value": "black"}, "size": {"value": 0.5}, "y": {"field": "zero", "type": "quantitative"}}}, {"mark": {"type": "bar", "width": 60}, "encoding": {"color": {"condition": {"test": "(datum.log2_bayes_factor < 0)", "value": "red"}, "value": "green"}, "opacity": {"condition": {"test": "datum.column_name == 'Prior match weight' || datum.column_name == 'Final score'", "value": 1}, "value": 0.5}, "tooltip": [{"field": "column_name", "title": "Comparison column", "type": "nominal"}, {"field": "value_l", "title": "Value (L)", "type": "nominal"}, {"field": "value_r", "title": "Value (R)", "type": "nominal"}, {"field": "label_for_charts", "title": "Label", "type": "ordinal"}, {"field": "sql_condition", "title": "SQL condition", "type": "nominal"}, {"field": "comparison_vector_value", "title": "Comparison vector value", "type": "nominal"}, {"field": "bayes_factor", "format": ",.4f", "title": "Bayes factor = m/u", "type": "quantitative"}, {"field": "log2_bayes_factor", "format": ",.4f", "title": "Match weight = log2(m/u)", "type": "quantitative"}, {"field": "prob", "format": ".4f", "title": "Cumulative match probability", "type": "quantitative"}, {"field": "bayes_factor_description", "title": "Match weight description", "type": "nominal"}], "x": {"axis": {"grid": true, "labelAlign": "center", "labelAngle": -20, "labelExpr": "datum.value == 'Prior' || datum.value == 'Final score' ? '' : datum.value", "labelPadding": 10, "tickBand": "extent", "title": "Column"}, "field": "column_name", "sort": {"field": "bar_sort_order", "order": "ascending"}, "type": "nominal"}, "y": {"axis": {"grid": false, "orient": "left", "title": "Match Weight"}, "field": "previous_sum", "type": "quantitative"}, "y2": {"field": "sum"}}}, {"mark": {"type": "text", "fontWeight": "bold"}, "encoding": {"color": {"value": "white"}, "text": {"condition": {"test": "abs(datum.log2_bayes_factor) > 1", "field": "log2_bayes_factor", "format": ".2f", "type": "nominal"}, "value": ""}, "x": {"axis": {"labelAngle": -20, "title": "Column"}, "field": "column_name", "sort": {"field": "bar_sort_order", "order": "ascending"}, "type": "nominal"}, "y": {"axis": {"orient": "left"}, "field": "center", "type": "quantitative"}}}, {"mark": {"type": "text", "baseline": "bottom", "dy": -25, "fontWeight": "bold"}, "encoding": {"color": {"value": "black"}, "text": {"field": "column_name", "type": "nominal"}, "x": {"axis": {"labelAngle": -20, "title": "Column"}, "field": "column_name", "sort": {"field": "bar_sort_order", "order": "ascending"}, "type": "nominal"}, "y": {"field": "sum_top", "type": "quantitative"}}}, {"mark": {"type": "text", "baseline": "bottom", "dy": -13, "fontSize": 8}, "encoding": {"color": {"value": "grey"}, "text": {"field": "value_l", "type": "nominal"}, "x": {"axis": {"labelAngle": -20, "title": "Column"}, "field": "column_name", "sort": {"field": "bar_sort_order", "order": "ascending"}, "type": "nominal"}, "y": {"field": "sum_top", "type": "quantitative"}}}, {"mark": {"type": "text", "baseline": "bottom", "dy": -5, "fontSize": 8}, "encoding": {"color": {"value": "grey"}, "text": {"field": "value_r", "type": "nominal"}, "x": {"axis": {"labelAngle": -20, "title": "Column"}, "field": "column_name", "sort": {"field": "bar_sort_order", "order": "ascending"}, "type": "nominal"}, "y": {"field": "sum_top", "type": "quantitative"}}}]}, {"mark": {"type": "rule", "color": "black", "strokeWidth": 2, "x2Offset": 30, "xOffset": -30}, "encoding": {"x": {"axis": {"labelAngle": -20, "title": "Column"}, "field": "column_name", "sort": {"field": "bar_sort_order", "order": "ascending"}, "type": "nominal"}, "x2": {"field": "lead"}, "y": {"axis": {"labelExpr": "format(1 / (1 + pow(2, -1*datum.value)), '.2r')", "orient": "right", "title": "Probability"}, "field": "sum", "scale": {"zero": false}, "type": "quantitative"}}}], "data": {"name": "data-1e294b14ffbe2dd10fecd8a4d9c66c77"}, "height": 450, "params": [{"name": "record_number", "bind": {"input": "range", "max": 1, "min": 0, "step": 1}, "value": 0}], "resolve": {"axis": {"y": "independent"}}, "title": {"text": "Match weights waterfall chart", "subtitle": "How each comparison contributes to the final match score"}, "transform": [{"filter": "(datum.record_number == record_number)"}, {"filter": "(datum.bayes_factor !== 1.0)"}, {"window": [{"op": "sum", "field": "log2_bayes_factor", "as": "sum"}, {"op": "lead", "field": "column_name", "as": "lead"}], "frame": [null, 0]}, {"calculate": "datum.column_name === \"Final score\" ? datum.sum - datum.log2_bayes_factor : datum.sum", "as": "sum"}, {"calculate": "datum.lead === null ? datum.column_name : datum.lead", "as": "lead"}, {"calculate": "datum.column_name === \"Final score\" || datum.column_name === \"Prior match weight\" ? 0 : datum.sum - datum.log2_bayes_factor", "as": "previous_sum"}, {"calculate": "datum.sum > datum.previous_sum ? datum.column_name : \"\"", "as": "top_label"}, {"calculate": "datum.sum < datum.previous_sum ? datum.column_name : \"\"", "as": "bottom_label"}, {"calculate": "datum.sum > datum.previous_sum ? datum.sum : datum.previous_sum", "as": "sum_top"}, {"calculate": "datum.sum < datum.previous_sum ? datum.sum : datum.previous_sum", "as": "sum_bottom"}, {"calculate": "(datum.sum + datum.previous_sum) / 2", "as": "center"}, {"calculate": "(datum.log2_bayes_factor > 0 ? \"+\" : \"\") + datum.log2_bayes_factor", "as": "text_log2_bayes_factor"}, {"calculate": "datum.sum < datum.previous_sum ? 4 : -4", "as": "dy"}, {"calculate": "datum.sum < datum.previous_sum ? \"top\" : \"bottom\"", "as": "baseline"}, {"calculate": "1. / (1 + pow(2, -1.*datum.sum))", "as": "prob"}, {"calculate": "0*datum.sum", "as": "zero"}], "width": {"step": 75}, "$schema": "https://vega.github.io/schema/vega-lite/v5.9.3.json", "datasets": {"data-1e294b14ffbe2dd10fecd8a4d9c66c77": [{"column_name": "Prior", "label_for_charts": "Starting match weight (prior)", "sql_condition": null, "log2_bayes_factor": -5.391889789559854, "bayes_factor": 0.023816582302252427, "comparison_vector_value": null, "m_probability": null, "u_probability": null, "bayes_factor_description": null, "value_l": "", "value_r": "", "term_frequency_adjustment": null, "bar_sort_order": 0, "record_number": 0}, {"column_name": "first_name", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": -2.1925340745596764, "bayes_factor": 0.21876683164040506, "comparison_vector_value": 0, "m_probability": 0.21528549148688833, "u_probability": 0.9840865266118626, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.57 times less likely to be a match", "value_l": "Olirev", "value_r": "Maryam", "term_frequency_adjustment": false, "bar_sort_order": 1, "record_number": 0}, {"column_name": "tf_first_name", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": 0.0, "bayes_factor": 1.0, "comparison_vector_value": 0, "m_probability": 0.21528549148688833, "u_probability": 0.9840865266118626, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.57 times less likely to be a match", "value_l": "", "value_r": "", "term_frequency_adjustment": true, "bar_sort_order": 2, "record_number": 0}, {"column_name": "surname", "label_for_charts": "exact_match", "sql_condition": "surname_l = surname_r", "log2_bayes_factor": 6.529599913880287, "bayes_factor": 92.38584465067325, "comparison_vector_value": 2, "m_probability": 0.4517645215191846, "u_probability": 0.004889975550122249, "bayes_factor_description": "If comparison level is `exact_match` then comparison is 92.39 times more likely to be a match", "value_l": "Jones", "value_r": "Jones", "term_frequency_adjustment": false, "bar_sort_order": 3, "record_number": 0}, {"column_name": "tf_surname", "label_for_charts": "Term freq adjustment on surname with weight {cl.tf_adjustment_weight}", "sql_condition": "surname_l = surname_r", "log2_bayes_factor": -2.521799347357753, "bayes_factor": 0.17412565111087489, "comparison_vector_value": 2, "m_probability": null, "u_probability": null, "bayes_factor_description": "Term frequency adjustment on surname makes comparison  5.74 times less likely to be a match", "value_l": "Jones", "value_r": "Jones", "term_frequency_adjustment": true, "bar_sort_order": 4, "record_number": 0}, {"column_name": "dob", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": -2.114723717091652, "bayes_factor": 0.23088978993311773, "comparison_vector_value": 0, "m_probability": 0.22653362300553073, "u_probability": 0.9811331331331331, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match", "value_l": "1991-08-29", "value_r": "1992-07-06", "term_frequency_adjustment": false, "bar_sort_order": 5, "record_number": 0}, {"column_name": "tf_dob", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": 0.0, "bayes_factor": 1.0, "comparison_vector_value": 0, "m_probability": 0.22653362300553073, "u_probability": 0.9811331331331331, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match", "value_l": "", "value_r": "", "term_frequency_adjustment": true, "bar_sort_order": 6, "record_number": 0}, {"column_name": "city", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": -1.1635794871398053, "bayes_factor": 0.4464035832880252, "comparison_vector_value": 0, "m_probability": 0.4217855099035769, "u_probability": 0.9448524288198547, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match", "value_l": "London", "value_r": "Coventry", "term_frequency_adjustment": false, "bar_sort_order": 7, "record_number": 0}, {"column_name": "tf_city", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": 0.0, "bayes_factor": 1.0, "comparison_vector_value": 0, "m_probability": 0.4217855099035769, "u_probability": 0.9448524288198547, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match", "value_l": "", "value_r": "", "term_frequency_adjustment": true, "bar_sort_order": 8, "record_number": 0}, {"column_name": "email", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": -1.239777184635766, "bayes_factor": 0.4234380485302649, "comparison_vector_value": 0, "m_probability": 0.42250907994219916, "u_probability": 0.9978061286856716, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match", "value_l": "oliverjones82@bond.biz", "value_r": "maryam.j47@myers.com", "term_frequency_adjustment": false, "bar_sort_order": 9, "record_number": 0}, {"column_name": "tf_email", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": 0.0, "bayes_factor": 1.0, "comparison_vector_value": 0, "m_probability": 0.42250907994219916, "u_probability": 0.9978061286856716, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match", "value_l": "", "value_r": "", "term_frequency_adjustment": true, "bar_sort_order": 10, "record_number": 0}, {"column_name": "Final score", "label_for_charts": "Final score", "sql_condition": null, "log2_bayes_factor": -8.09470368646422, "bayes_factor": 0.0036580647152475937, "comparison_vector_value": null, "m_probability": null, "u_probability": null, "bayes_factor_description": null, "value_l": "", "value_r": "", "term_frequency_adjustment": null, "bar_sort_order": 11, "record_number": 0}, {"column_name": "Prior", "label_for_charts": "Starting match weight (prior)", "sql_condition": null, "log2_bayes_factor": -5.391889789559854, "bayes_factor": 0.023816582302252427, "comparison_vector_value": null, "m_probability": null, "u_probability": null, "bayes_factor_description": null, "value_l": "", "value_r": "", "term_frequency_adjustment": null, "bar_sort_order": 0, "record_number": 1}, {"column_name": "first_name", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": -2.1925340745596764, "bayes_factor": 0.21876683164040506, "comparison_vector_value": 0, "m_probability": 0.21528549148688833, "u_probability": 0.9840865266118626, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.57 times less likely to be a match", "value_l": "Olirev", "value_r": "Isaac", "term_frequency_adjustment": false, "bar_sort_order": 1, "record_number": 1}, {"column_name": "tf_first_name", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": 0.0, "bayes_factor": 1.0, "comparison_vector_value": 0, "m_probability": 0.21528549148688833, "u_probability": 0.9840865266118626, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.57 times less likely to be a match", "value_l": "", "value_r": "", "term_frequency_adjustment": true, "bar_sort_order": 2, "record_number": 1}, {"column_name": "surname", "label_for_charts": "exact_match", "sql_condition": "surname_l = surname_r", "log2_bayes_factor": 6.529599913880287, "bayes_factor": 92.38584465067325, "comparison_vector_value": 2, "m_probability": 0.4517645215191846, "u_probability": 0.004889975550122249, "bayes_factor_description": "If comparison level is `exact_match` then comparison is 92.39 times more likely to be a match", "value_l": "Jones", "value_r": "Jones", "term_frequency_adjustment": false, "bar_sort_order": 3, "record_number": 1}, {"column_name": "tf_surname", "label_for_charts": "Term freq adjustment on surname with weight {cl.tf_adjustment_weight}", "sql_condition": "surname_l = surname_r", "log2_bayes_factor": -2.521799347357753, "bayes_factor": 0.17412565111087489, "comparison_vector_value": 2, "m_probability": null, "u_probability": null, "bayes_factor_description": "Term frequency adjustment on surname makes comparison  5.74 times less likely to be a match", "value_l": "Jones", "value_r": "Jones", "term_frequency_adjustment": true, "bar_sort_order": 4, "record_number": 1}, {"column_name": "dob", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": -2.114723717091652, "bayes_factor": 0.23088978993311773, "comparison_vector_value": 0, "m_probability": 0.22653362300553073, "u_probability": 0.9811331331331331, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match", "value_l": "1991-08-29", "value_r": "2008-02-23", "term_frequency_adjustment": false, "bar_sort_order": 5, "record_number": 1}, {"column_name": "tf_dob", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": 0.0, "bayes_factor": 1.0, "comparison_vector_value": 0, "m_probability": 0.22653362300553073, "u_probability": 0.9811331331331331, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match", "value_l": "", "value_r": "", "term_frequency_adjustment": true, "bar_sort_order": 6, "record_number": 1}, {"column_name": "city", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": -1.1635794871398053, "bayes_factor": 0.4464035832880252, "comparison_vector_value": 0, "m_probability": 0.4217855099035769, "u_probability": 0.9448524288198547, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match", "value_l": "London", "value_r": "Baltasf", "term_frequency_adjustment": false, "bar_sort_order": 7, "record_number": 1}, {"column_name": "tf_city", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": 0.0, "bayes_factor": 1.0, "comparison_vector_value": 0, "m_probability": 0.4217855099035769, "u_probability": 0.9448524288198547, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match", "value_l": "", "value_r": "", "term_frequency_adjustment": true, "bar_sort_order": 8, "record_number": 1}, {"column_name": "email", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": -1.239777184635766, "bayes_factor": 0.4234380485302649, "comparison_vector_value": 0, "m_probability": 0.42250907994219916, "u_probability": 0.9978061286856716, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match", "value_l": "oliverjones82@bond.biz", "value_r": "isaac.jones54@bradford.enet", "term_frequency_adjustment": false, "bar_sort_order": 9, "record_number": 1}, {"column_name": "tf_email", "label_for_charts": "All other comparisons", "sql_condition": "ELSE", "log2_bayes_factor": 0.0, "bayes_factor": 1.0, "comparison_vector_value": 0, "m_probability": 0.42250907994219916, "u_probability": 0.9978061286856716, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match", "value_l": "", "value_r": "", "term_frequency_adjustment": true, "bar_sort_order": 10, "record_number": 1}, {"column_name": "Final score", "label_for_charts": "Final score", "sql_condition": null, "log2_bayes_factor": -8.09470368646422, "bayes_factor": 0.0036580647152475937, "comparison_vector_value": null, "m_probability": null, "u_probability": null, "bayes_factor_description": null, "value_l": "", "value_r": "", "term_frequency_adjustment": null, "bar_sort_order": 11, "record_number": 1}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="step-comparing-two-records" class="level3">
<h3 class="anchored" data-anchor-id="step-comparing-two-records">Step Comparing two records</h3>
<p>It’s now possible to compute a match weight for any two records using <code>linker.compare_two_records()</code></p>
<div id="36176985" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> splink.term_frequencies <span class="im">import</span> compute_term_frequencies_from_concat_with_tf</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>record_1  <span class="op">=</span> {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>     <span class="st">'unique_id'</span>:<span class="dv">1</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>     <span class="st">'first_name'</span>: <span class="st">"Lucas"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">'surname'</span>: <span class="st">"Smith"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">'dob'</span>: <span class="st">"1984-01-02"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">'city'</span>: <span class="st">"London"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>     <span class="st">'email'</span>: <span class="st">"lucas.smith@hotmail.com"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>record_2  <span class="op">=</span> {</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>     <span class="st">'unique_id'</span>:<span class="dv">2</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>     <span class="st">'first_name'</span>: <span class="st">"Lucas"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>     <span class="st">'surname'</span>: <span class="st">"Smith"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>     <span class="st">'dob'</span>: <span class="st">"1983-02-12"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>     <span class="st">'city'</span>: <span class="st">"Machester"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>     <span class="st">'email'</span>: <span class="st">"lucas.smith@hotmail.com"</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>linker._settings_obj_._retain_intermediate_calculation_columns <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>linker._settings_obj_._retain_matching_columns <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>linker.compute_tf_table(<span class="st">"first_name"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>linker.compute_tf_table(<span class="st">"surname"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>linker.compute_tf_table(<span class="st">"dob"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>linker.compute_tf_table(<span class="st">"city"</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>linker.compute_tf_table(<span class="st">"email"</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>df_two <span class="op">=</span> linker.compare_two_records(record_1, record_2)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>df_two.as_pandas_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match_weight</th>
<th data-quarto-table-cell-role="th">match_probability</th>
<th data-quarto-table-cell-role="th">unique_id_l</th>
<th data-quarto-table-cell-role="th">unique_id_r</th>
<th data-quarto-table-cell-role="th">first_name_l</th>
<th data-quarto-table-cell-role="th">first_name_r</th>
<th data-quarto-table-cell-role="th">gamma_first_name</th>
<th data-quarto-table-cell-role="th">tf_first_name_l</th>
<th data-quarto-table-cell-role="th">tf_first_name_r</th>
<th data-quarto-table-cell-role="th">bf_first_name</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">tf_city_r</th>
<th data-quarto-table-cell-role="th">bf_city</th>
<th data-quarto-table-cell-role="th">bf_tf_adj_city</th>
<th data-quarto-table-cell-role="th">email_l</th>
<th data-quarto-table-cell-role="th">email_r</th>
<th data-quarto-table-cell-role="th">gamma_email</th>
<th data-quarto-table-cell-role="th">tf_email_l</th>
<th data-quarto-table-cell-role="th">tf_email_r</th>
<th data-quarto-table-cell-role="th">bf_email</th>
<th data-quarto-table-cell-role="th">bf_tf_adj_email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>13.161672</td>
<td>0.999891</td>
<td>1</td>
<td>2</td>
<td>Lucas</td>
<td>Lucas</td>
<td>2</td>
<td>0.001203</td>
<td>0.001203</td>
<td>87.571229</td>
<td>...</td>
<td>NaN</td>
<td>0.446404</td>
<td>1.0</td>
<td>lucas.smith@hotmail.com</td>
<td>lucas.smith@hotmail.com</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>263.229168</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>1 rows × 39 columns</p>
</div>
</div>
</div>
</section>
<section id="step-3-interactive-comparisons" class="level3">
<h3 class="anchored" data-anchor-id="step-3-interactive-comparisons">Step 3: Interactive comparisons</h3>
<p>One interesting applicatin of <code>compare_two_records</code> is to create a simple interface that allows the user to input two records interactively, and get real time feedback.</p>
<p>In the following cell we use <code>ipywidets</code> for this purpose. ✨✨ Change the values in the text boxes to see the waterfall chart update in real time. ✨✨</p>
<div id="6041859a" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ipywidgets <span class="im">as</span> widgets</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fields <span class="op">=</span> [<span class="st">"unique_id"</span>, <span class="st">"first_name"</span>,<span class="st">"surname"</span>,<span class="st">"dob"</span>,<span class="st">"email"</span>,<span class="st">"city"</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>left_text_boxes <span class="op">=</span> []</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>right_text_boxes <span class="op">=</span> []</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>inputs_to_interactive_output <span class="op">=</span> {}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> fields:</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    wl <span class="op">=</span> widgets.Text(description<span class="op">=</span>f, value <span class="op">=</span><span class="bu">str</span>(record_1[f]))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    left_text_boxes.append(wl)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    inputs_to_interactive_output[<span class="ss">f"</span><span class="sc">{</span>f<span class="sc">}</span><span class="ss">_l"</span>] <span class="op">=</span> wl</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    wr <span class="op">=</span> widgets.Text( description<span class="op">=</span>f, value <span class="op">=</span><span class="bu">str</span>(record_2[f]))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    right_text_boxes.append(wr)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    inputs_to_interactive_output[<span class="ss">f"</span><span class="sc">{</span>f<span class="sc">}</span><span class="ss">_r"</span>] <span class="op">=</span> wr</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> widgets.VBox(left_text_boxes)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> widgets.VBox(right_text_boxes)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>ui <span class="op">=</span> widgets.HBox([b1,b2])</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> myfn(<span class="op">**</span>kwargs):</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    my_args <span class="op">=</span> <span class="bu">dict</span>(kwargs)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    record_left <span class="op">=</span> {}</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    record_right <span class="op">=</span> {}</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> my_args.items():</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> value <span class="op">==</span> <span class="st">''</span>:</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>            value <span class="op">=</span> <span class="va">None</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> key.endswith(<span class="st">"_l"</span>):</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>            record_left[key[:<span class="op">-</span><span class="dv">2</span>]] <span class="op">=</span> value</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> key.endswith(<span class="st">"_r"</span>):</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>            record_right[key[:<span class="op">-</span><span class="dv">2</span>]] <span class="op">=</span> value</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    linker._settings_obj_._retain_intermediate_calculation_columns <span class="op">=</span> <span class="va">True</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    linker._settings_obj_._retain_matching_columns <span class="op">=</span> <span class="va">True</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    df_two <span class="op">=</span> linker.compare_two_records(record_left, record_right)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    recs <span class="op">=</span> df_two.as_pandas_dataframe().to_dict(orient<span class="op">=</span><span class="st">"records"</span>)</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> splink.charts <span class="im">import</span> waterfall_chart</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    display(linker.waterfall_chart(recs, filter_nulls<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> widgets.interactive_output(myfn, inputs_to_interactive_output)</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>display(ui,out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ca611417070848fa8244b01835c24563","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c47b5273ae244bf5b4ee85b683479e87","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="finding-matching-records-interactively" class="level2">
<h2 class="anchored" data-anchor-id="finding-matching-records-interactively">Finding matching records interactively</h2>
<p>It is also possible to search the records in the input dataset rapidly using the <code>linker.find_matches_to_new_records()</code> function</p>
<div id="19627354" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>record <span class="op">=</span> {<span class="st">'unique_id'</span>: <span class="dv">123987</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'first_name'</span>: <span class="st">"Robert"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'surname'</span>: <span class="st">"Alan"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'dob'</span>: <span class="st">"1971-05-24"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'city'</span>: <span class="st">"London"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'email'</span>: <span class="st">"robert255@smith.net"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>df_inc <span class="op">=</span> linker.find_matches_to_new_records([record], blocking_rules<span class="op">=</span>[]).as_pandas_dataframe()</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df_inc.sort_values(<span class="st">"match_weight"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match_weight</th>
<th data-quarto-table-cell-role="th">match_probability</th>
<th data-quarto-table-cell-role="th">unique_id_l</th>
<th data-quarto-table-cell-role="th">unique_id_r</th>
<th data-quarto-table-cell-role="th">first_name_l</th>
<th data-quarto-table-cell-role="th">first_name_r</th>
<th data-quarto-table-cell-role="th">gamma_first_name</th>
<th data-quarto-table-cell-role="th">tf_first_name_l</th>
<th data-quarto-table-cell-role="th">tf_first_name_r</th>
<th data-quarto-table-cell-role="th">bf_first_name</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">tf_city_r</th>
<th data-quarto-table-cell-role="th">bf_city</th>
<th data-quarto-table-cell-role="th">bf_tf_adj_city</th>
<th data-quarto-table-cell-role="th">email_l</th>
<th data-quarto-table-cell-role="th">email_r</th>
<th data-quarto-table-cell-role="th">gamma_email</th>
<th data-quarto-table-cell-role="th">tf_email_l</th>
<th data-quarto-table-cell-role="th">tf_email_r</th>
<th data-quarto-table-cell-role="th">bf_email</th>
<th data-quarto-table-cell-role="th">bf_tf_adj_email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>23.531793</td>
<td>1.000000</td>
<td>0</td>
<td>123987</td>
<td>Robert</td>
<td>Robert</td>
<td>2</td>
<td>0.003610</td>
<td>0.00361</td>
<td>87.571229</td>
<td>...</td>
<td>0.212792</td>
<td>1.000000</td>
<td>1.000000</td>
<td>robert255@smith.net</td>
<td>robert255@smith.net</td>
<td>1</td>
<td>0.001267</td>
<td>0.001267</td>
<td>263.229168</td>
<td>1.730964</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>14.550320</td>
<td>0.999958</td>
<td>1</td>
<td>123987</td>
<td>Robert</td>
<td>Robert</td>
<td>2</td>
<td>0.003610</td>
<td>0.00361</td>
<td>87.571229</td>
<td>...</td>
<td>0.212792</td>
<td>1.000000</td>
<td>1.000000</td>
<td>roberta25@smith.net</td>
<td>robert255@smith.net</td>
<td>0</td>
<td>0.002535</td>
<td>0.001267</td>
<td>0.423438</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>10.388623</td>
<td>0.999255</td>
<td>3</td>
<td>123987</td>
<td>Robert</td>
<td>Robert</td>
<td>2</td>
<td>0.003610</td>
<td>0.00361</td>
<td>87.571229</td>
<td>...</td>
<td>0.212792</td>
<td>0.446404</td>
<td>1.000000</td>
<td>None</td>
<td>robert255@smith.net</td>
<td>-1</td>
<td>NaN</td>
<td>0.001267</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.427256</td>
<td>0.843228</td>
<td>2</td>
<td>123987</td>
<td>Rob</td>
<td>Robert</td>
<td>0</td>
<td>0.001203</td>
<td>0.00361</td>
<td>0.218767</td>
<td>...</td>
<td>0.212792</td>
<td>10.484859</td>
<td>0.259162</td>
<td>roberta25@smith.net</td>
<td>robert255@smith.net</td>
<td>0</td>
<td>0.002535</td>
<td>0.001267</td>
<td>0.423438</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-2.123090</td>
<td>0.186697</td>
<td>8</td>
<td>123987</td>
<td>None</td>
<td>Robert</td>
<td>-1</td>
<td>NaN</td>
<td>0.00361</td>
<td>1.000000</td>
<td>...</td>
<td>0.212792</td>
<td>1.000000</td>
<td>1.000000</td>
<td>None</td>
<td>robert255@smith.net</td>
<td>-1</td>
<td>NaN</td>
<td>0.001267</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-2.205894</td>
<td>0.178139</td>
<td>754</td>
<td>123987</td>
<td>None</td>
<td>Robert</td>
<td>-1</td>
<td>NaN</td>
<td>0.00361</td>
<td>1.000000</td>
<td>...</td>
<td>0.212792</td>
<td>1.000000</td>
<td>1.000000</td>
<td>j.c@whige.wort</td>
<td>robert255@smith.net</td>
<td>0</td>
<td>0.001267</td>
<td>0.001267</td>
<td>0.423438</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-2.802309</td>
<td>0.125383</td>
<td>750</td>
<td>123987</td>
<td>None</td>
<td>Robert</td>
<td>-1</td>
<td>NaN</td>
<td>0.00361</td>
<td>1.000000</td>
<td>...</td>
<td>0.212792</td>
<td>10.484859</td>
<td>0.259162</td>
<td>j.c@white.org</td>
<td>robert255@smith.net</td>
<td>0</td>
<td>0.002535</td>
<td>0.001267</td>
<td>0.423438</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

<p>7 rows × 39 columns</p>
</div>
</div>
</div>
</section>
<section id="interactive-interface-for-finding-records" class="level2">
<h2 class="anchored" data-anchor-id="interactive-interface-for-finding-records">Interactive interface for finding records</h2>
<p>Again, we can use <code>ipywidgets</code> to build an interactive interface for the <code>linker.find_matches_to_new_records</code> function</p>
<div id="e4ffaa3c" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> splink.charts <span class="im">import</span> waterfall_chart</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">@widgets.interact</span>(first_name<span class="op">=</span><span class="st">'Robert'</span>, surname<span class="op">=</span><span class="st">"Alan"</span>, dob<span class="op">=</span><span class="st">"1971-05-24"</span>, city<span class="op">=</span><span class="st">"London"</span>, email<span class="op">=</span><span class="st">"robert255@smith.net"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interactive_link(first_name, surname, dob, city, email):    </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    record <span class="op">=</span> {<span class="st">'unique_id'</span>: <span class="dv">123987</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">'first_name'</span>: first_name,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>     <span class="st">'surname'</span>: surname,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>     <span class="st">'dob'</span>: dob,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>     <span class="st">'city'</span>: city,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>     <span class="st">'email'</span>: email,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>     <span class="st">'group'</span>: <span class="dv">0</span>}</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key <span class="kw">in</span> record.keys():</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">type</span>(record[key]) <span class="op">==</span> <span class="bu">str</span>:</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> record[key].strip() <span class="op">==</span> <span class="st">""</span>:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                record[key] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    df_inc <span class="op">=</span> linker.find_matches_to_new_records([record], blocking_rules<span class="op">=</span>[<span class="ss">f"(true)"</span>]).as_pandas_dataframe()</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    df_inc <span class="op">=</span> df_inc.sort_values(<span class="st">"match_weight"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    recs <span class="op">=</span> df_inc.to_dict(orient<span class="op">=</span><span class="st">"records"</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    display(linker.waterfall_chart(recs, filter_nulls<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8545cee6c5444c7aa0d47a268026fcb7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div id="6908326f" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>linker.match_weights_chart()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<style>
  #altair-viz-0c05f13494844fb78bfb6095fb5e29fa.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-0c05f13494844fb78bfb6095fb5e29fa.vega-embed details,
  #altair-viz-0c05f13494844fb78bfb6095fb5e29fa.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0c05f13494844fb78bfb6095fb5e29fa"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0c05f13494844fb78bfb6095fb5e29fa") {
      outputDiv = document.getElementById("altair-viz-0c05f13494844fb78bfb6095fb5e29fa");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.16.3?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.16.3"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "discreteHeight": 60, "discreteWidth": 400}, "header": {"title": null}, "mark": {"tooltip": null}, "title": {"anchor": "middle"}}, "vconcat": [{"mark": {"type": "bar", "clip": true, "height": 15}, "encoding": {"color": {"field": "log2_bayes_factor", "scale": {"domain": [-10, 0, 10], "interpolate": "lab", "range": ["red", "#bbbbbb", "green"]}, "title": "Match weight", "type": "quantitative"}, "tooltip": [{"field": "comparison_name", "title": "Comparison name", "type": "nominal"}, {"field": "probability_two_random_records_match", "format": ".4f", "title": "Probability two random records match", "type": "nominal"}, {"field": "log2_bayes_factor", "format": ",.4f", "title": "Equivalent match weight", "type": "quantitative"}, {"field": "bayes_factor_description", "title": "Match weight description", "type": "nominal"}], "x": {"axis": {"domain": false, "gridColor": {"condition": {"test": "abs(datum.value / 10)  <= 1 & datum.value % 10 === 0", "value": "#aaa"}, "value": "#ddd"}, "gridDash": {"condition": {"test": "abs(datum.value / 10) == 1", "value": [3]}, "value": null}, "gridWidth": {"condition": {"test": "abs(datum.value / 10)  <= 1 & datum.value % 10 === 0", "value": 2}, "value": 1}, "labels": false, "ticks": false, "title": ""}, "field": "log2_bayes_factor", "scale": {"domain": [-9, 9]}, "type": "quantitative"}, "y": {"axis": {"title": "Prior (starting) match weight", "titleAlign": "right", "titleAngle": 0, "titleFontWeight": "normal"}, "field": "label_for_charts", "sort": {"field": "comparison_vector_value", "order": "descending"}, "type": "nominal"}}, "height": 20, "transform": [{"filter": "(datum.comparison_name == 'probability_two_random_records_match')"}]}, {"mark": {"type": "bar", "clip": true}, "encoding": {"color": {"field": "log2_bayes_factor", "scale": {"domain": [-10, 0, 10], "interpolate": "lab", "range": ["red", "#bbbbbb", "green"]}, "title": "Match weight", "type": "quantitative"}, "row": {"field": "comparison_name", "header": {"labelAlign": "left", "labelAnchor": "middle", "labelAngle": 0}, "sort": {"field": "comparison_sort_order"}, "type": "nominal"}, "tooltip": [{"field": "comparison_name", "title": "Comparison name", "type": "nominal"}, {"field": "label_for_charts", "title": "Label", "type": "ordinal"}, {"field": "sql_condition", "title": "SQL condition", "type": "nominal"}, {"field": "m_probability", "format": ".4f", "title": "M probability", "type": "quantitative"}, {"field": "u_probability", "format": ".4f", "title": "U probability", "type": "quantitative"}, {"field": "bayes_factor", "format": ",.4f", "title": "Bayes factor = m/u", "type": "quantitative"}, {"field": "log2_bayes_factor", "format": ",.4f", "title": "Match weight = log2(m/u)", "type": "quantitative"}, {"field": "bayes_factor_description", "title": "Match weight description", "type": "nominal"}], "x": {"axis": {"gridColor": {"condition": {"test": "abs(datum.value / 10)  <= 1 & datum.value % 10 === 0", "value": "#aaa"}, "value": "#ddd"}, "gridDash": {"condition": {"test": "abs(datum.value / 10) == 1", "value": [3]}, "value": null}, "gridWidth": {"condition": {"test": "abs(datum.value / 10)  <= 1 & datum.value % 10 === 0", "value": 2}, "value": 1}, "title": "Comparison level match weight = log2(m/u)"}, "field": "log2_bayes_factor", "scale": {"domain": [-9, 9]}, "type": "quantitative"}, "y": {"axis": {"title": null}, "field": "label_for_charts", "sort": {"field": "comparison_vector_value", "order": "descending"}, "type": "nominal"}}, "height": {"step": 12}, "resolve": {"axis": {"y": "independent"}, "scale": {"y": "independent"}}, "transform": [{"filter": "(datum.comparison_name != 'probability_two_random_records_match')"}]}], "data": {"name": "data-cc3f059e01f0b977f7963a6bf874835a"}, "params": [{"name": "mouse_zoom", "select": {"type": "interval", "encodings": ["x"]}, "bind": "scales", "views": []}], "resolve": {"axis": {"y": "independent"}, "scale": {"y": "independent"}}, "title": {"text": "Model parameters (components of final match weight)", "subtitle": "Use mousewheel to zoom"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.9.3.json", "datasets": {"data-cc3f059e01f0b977f7963a6bf874835a": [{"comparison_name": "probability_two_random_records_match", "sql_condition": null, "label_for_charts": "", "m_probability": null, "u_probability": null, "m_probability_description": null, "u_probability_description": null, "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": null, "is_null_level": false, "bayes_factor": 0.023816582302252427, "log2_bayes_factor": -5.391889789559854, "comparison_vector_value": 0, "max_comparison_vector_value": 0, "bayes_factor_description": "The probability that two random records drawn at random match is 0.023 or one in  43.0 records.This is equivalent to a starting match weight of -5.392.", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": -1}, {"comparison_name": "first_name", "sql_condition": "first_name_l = first_name_r", "label_for_charts": "exact_match", "m_probability": 0.5073501669215337, "u_probability": 0.0057935713975033705, "m_probability_description": "Amongst matching record comparisons, 50.74% of records are in the exact_match comparison level", "u_probability_description": "Amongst non-matching record comparisons, 0.58% of records are in the exact_match comparison level", "has_tf_adjustments": true, "tf_adjustment_column": "first_name", "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 87.57122888658395, "log2_bayes_factor": 6.452385051922501, "comparison_vector_value": 2, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `exact_match` then comparison is 87.57 times more likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 0}, {"comparison_name": "first_name", "sql_condition": "levenshtein(first_name_l, first_name_r) <= 2", "label_for_charts": "Levenstein <= 2", "m_probability": 0.27736434159157797, "u_probability": 0.010119901990634016, "m_probability_description": "Amongst matching record comparisons, 27.74% of records are in the levenstein <= 2 comparison level", "u_probability_description": "Amongst non-matching record comparisons, 1.01% of records are in the levenstein <= 2 comparison level", "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 27.407809072486973, "log2_bayes_factor": 4.776515101395072, "comparison_vector_value": 1, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `levenstein <= 2` then comparison is 27.41 times more likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 0}, {"comparison_name": "first_name", "sql_condition": "ELSE", "label_for_charts": "All other comparisons", "m_probability": 0.21528549148688833, "u_probability": 0.9840865266118626, "m_probability_description": "Amongst matching record comparisons, 21.53% of records are in the all other comparisons comparison level", "u_probability_description": "Amongst non-matching record comparisons, 98.41% of records are in the all other comparisons comparison level", "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 0.21876683164040506, "log2_bayes_factor": -2.1925340745596764, "comparison_vector_value": 0, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.57 times less likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 0}, {"comparison_name": "surname", "sql_condition": "surname_l = surname_r", "label_for_charts": "exact_match", "m_probability": 0.4517645215191846, "u_probability": 0.004889975550122249, "m_probability_description": "Amongst matching record comparisons, 45.18% of records are in the exact_match comparison level", "u_probability_description": "Amongst non-matching record comparisons, 0.49% of records are in the exact_match comparison level", "has_tf_adjustments": true, "tf_adjustment_column": "surname", "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 92.38584465067325, "log2_bayes_factor": 6.529599913880287, "comparison_vector_value": 2, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `exact_match` then comparison is 92.39 times more likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 1}, {"comparison_name": "surname", "sql_condition": "levenshtein(surname_l, surname_r) <= 2", "label_for_charts": "Levenstein <= 2", "m_probability": 0.3078165102205689, "u_probability": 0.007373772654946249, "m_probability_description": "Amongst matching record comparisons, 30.78% of records are in the levenstein <= 2 comparison level", "u_probability_description": "Amongst non-matching record comparisons, 0.74% of records are in the levenstein <= 2 comparison level", "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 41.74477904659683, "log2_bayes_factor": 5.383523868172574, "comparison_vector_value": 1, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 1}, {"comparison_name": "surname", "sql_condition": "ELSE", "label_for_charts": "All other comparisons", "m_probability": 0.24041896826024636, "u_probability": 0.9877362517949315, "m_probability_description": "Amongst matching record comparisons, 24.04% of records are in the all other comparisons comparison level", "u_probability_description": "Amongst non-matching record comparisons, 98.77% of records are in the all other comparisons comparison level", "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 0.24340401379756268, "log2_bayes_factor": -2.03857513621085, "comparison_vector_value": 0, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.11 times less likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 1}, {"comparison_name": "dob", "sql_condition": "dob_l = dob_r", "label_for_charts": "exact_match", "m_probability": 0.405530771330678, "u_probability": 0.0017477477477477479, "m_probability_description": "Amongst matching record comparisons, 40.55% of records are in the exact_match comparison level", "u_probability_description": "Amongst non-matching record comparisons, 0.17% of records are in the exact_match comparison level", "has_tf_adjustments": true, "tf_adjustment_column": "dob", "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 232.03049287476935, "log2_bayes_factor": 7.858170603008739, "comparison_vector_value": 2, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `exact_match` then comparison is 232.03 times more likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 2}, {"comparison_name": "dob", "sql_condition": "levenshtein(dob_l, dob_r) <= 2", "label_for_charts": "Levenstein <= 2", "m_probability": 0.3679356056637918, "u_probability": 0.01711911911911912, "m_probability_description": "Amongst matching record comparisons, 36.79% of records are in the levenstein <= 2 comparison level", "u_probability_description": "Amongst non-matching record comparisons, 1.71% of records are in the levenstein <= 2 comparison level", "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 21.492671620753597, "log2_bayes_factor": 4.425772921275592, "comparison_vector_value": 1, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 2}, {"comparison_name": "dob", "sql_condition": "ELSE", "label_for_charts": "All other comparisons", "m_probability": 0.22653362300553073, "u_probability": 0.9811331331331331, "m_probability_description": "Amongst matching record comparisons, 22.65% of records are in the all other comparisons comparison level", "u_probability_description": "Amongst non-matching record comparisons, 98.11% of records are in the all other comparisons comparison level", "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 0.23088978993311773, "log2_bayes_factor": -2.114723717091652, "comparison_vector_value": 0, "max_comparison_vector_value": 2, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 2}, {"comparison_name": "city", "sql_condition": "city_l = city_r", "label_for_charts": "exact_match", "m_probability": 0.5782144900964232, "u_probability": 0.0551475711801453, "m_probability_description": "Amongst matching record comparisons, 57.82% of records are in the exact_match comparison level", "u_probability_description": "Amongst non-matching record comparisons, 5.51% of records are in the exact_match comparison level", "has_tf_adjustments": true, "tf_adjustment_column": "city", "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 10.484858675056154, "log2_bayes_factor": 3.3902355104306197, "comparison_vector_value": 1, "max_comparison_vector_value": 1, "bayes_factor_description": "If comparison level is `exact_match` then comparison is 10.48 times more likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 3}, {"comparison_name": "city", "sql_condition": "ELSE", "label_for_charts": "All other comparisons", "m_probability": 0.4217855099035769, "u_probability": 0.9448524288198547, "m_probability_description": "Amongst matching record comparisons, 42.18% of records are in the all other comparisons comparison level", "u_probability_description": "Amongst non-matching record comparisons, 94.49% of records are in the all other comparisons comparison level", "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 0.4464035832880252, "log2_bayes_factor": -1.1635794871398053, "comparison_vector_value": 0, "max_comparison_vector_value": 1, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 3}, {"comparison_name": "email", "sql_condition": "email_l = email_r", "label_for_charts": "exact_match", "m_probability": 0.5774909200578013, "u_probability": 0.0021938713143283602, "m_probability_description": "Amongst matching record comparisons, 57.75% of records are in the exact_match comparison level", "u_probability_description": "Amongst non-matching record comparisons, 0.22% of records are in the exact_match comparison level", "has_tf_adjustments": true, "tf_adjustment_column": "email", "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 263.2291676754963, "log2_bayes_factor": 8.04017554864013, "comparison_vector_value": 1, "max_comparison_vector_value": 1, "bayes_factor_description": "If comparison level is `exact_match` then comparison is 263.23 times more likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 4}, {"comparison_name": "email", "sql_condition": "ELSE", "label_for_charts": "All other comparisons", "m_probability": 0.42250907994219916, "u_probability": 0.9978061286856716, "m_probability_description": "Amongst matching record comparisons, 42.25% of records are in the all other comparisons comparison level", "u_probability_description": "Amongst non-matching record comparisons, 99.78% of records are in the all other comparisons comparison level", "has_tf_adjustments": false, "tf_adjustment_column": null, "tf_adjustment_weight": 1.0, "is_null_level": false, "bayes_factor": 0.4234380485302649, "log2_bayes_factor": -1.239777184635766, "comparison_vector_value": 0, "max_comparison_vector_value": 1, "bayes_factor_description": "If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match", "probability_two_random_records_match": 0.02326254791526835, "comparison_sort_order": 4}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script type="application/vnd.jupyter.widget-state+json">
{"state":{"014274444095416d91fefd10139b148c":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/output","_model_module_version":"1.0.0","_model_name":"OutputModel","_view_count":null,"_view_module":"@jupyter-widgets/output","_view_module_version":"1.0.0","_view_name":"OutputView","layout":"IPY_MODEL_dbecc9c029184e27964189e6e9c569a0","msg_id":"","outputs":[{"data":{"text/html":"\n<style>\n  #altair-viz-df6a571386c6484aa165003a6a576796.vega-embed {\n    width: 100%;\n    display: flex;\n  }\n\n  #altair-viz-df6a571386c6484aa165003a6a576796.vega-embed details,\n  #altair-viz-df6a571386c6484aa165003a6a576796.vega-embed details summary {\n    position: relative;\n  }\n</style>\n<div id=\"altair-viz-df6a571386c6484aa165003a6a576796\"></div>\n<script type=\"text/javascript\">\n  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n  (function(spec, embedOpt){\n    let outputDiv = document.currentScript.previousElementSibling;\n    if (outputDiv.id !== \"altair-viz-df6a571386c6484aa165003a6a576796\") {\n      outputDiv = document.getElementById(\"altair-viz-df6a571386c6484aa165003a6a576796\");\n    }\n    const paths = {\n      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@5?noext\",\n      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@5.16.3?noext\",\n      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@6?noext\",\n    };\n\n    function maybeLoadScript(lib, version) {\n      var key = `${lib.replace(\"-\", \"\")}_version`;\n      return (VEGA_DEBUG[key] == version) ?\n        Promise.resolve(paths[lib]) :\n        new Promise(function(resolve, reject) {\n          var s = document.createElement('script');\n          document.getElementsByTagName(\"head\")[0].appendChild(s);\n          s.async = true;\n          s.onload = () => {\n            VEGA_DEBUG[key] = version;\n            return resolve(paths[lib]);\n          };\n          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n          s.src = paths[lib];\n        });\n    }\n\n    function showError(err) {\n      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n      throw err;\n    }\n\n    function displayChart(vegaEmbed) {\n      vegaEmbed(outputDiv, spec, embedOpt)\n        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n    }\n\n    if(typeof define === \"function\" && define.amd) {\n      requirejs.config({paths});\n      require([\"vega-embed\"], displayChart, err => showError(`Error loading script: ${err.message}`));\n    } else {\n      maybeLoadScript(\"vega\", \"5\")\n        .then(() => maybeLoadScript(\"vega-lite\", \"5.16.3\"))\n        .then(() => maybeLoadScript(\"vega-embed\", \"6\"))\n        .catch(showError)\n        .then(() => displayChart(vegaEmbed));\n    }\n  })({\"config\": {\"view\": {\"continuousWidth\": 400, \"continuousHeight\": 300}}, \"layer\": [{\"layer\": [{\"mark\": \"rule\", \"encoding\": {\"color\": {\"value\": \"black\"}, \"size\": {\"value\": 0.5}, \"y\": {\"field\": \"zero\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"bar\", \"width\": 60}, \"encoding\": {\"color\": {\"condition\": {\"test\": \"(datum.log2_bayes_factor < 0)\", \"value\": \"red\"}, \"value\": \"green\"}, \"opacity\": {\"condition\": {\"test\": \"datum.column_name == 'Prior match weight' || datum.column_name == 'Final score'\", \"value\": 1}, \"value\": 0.5}, \"tooltip\": [{\"field\": \"column_name\", \"title\": \"Comparison column\", \"type\": \"nominal\"}, {\"field\": \"value_l\", \"title\": \"Value (L)\", \"type\": \"nominal\"}, {\"field\": \"value_r\", \"title\": \"Value (R)\", \"type\": \"nominal\"}, {\"field\": \"label_for_charts\", \"title\": \"Label\", \"type\": \"ordinal\"}, {\"field\": \"sql_condition\", \"title\": \"SQL condition\", \"type\": \"nominal\"}, {\"field\": \"comparison_vector_value\", \"title\": \"Comparison vector value\", \"type\": \"nominal\"}, {\"field\": \"bayes_factor\", \"format\": \",.4f\", \"title\": \"Bayes factor = m/u\", \"type\": \"quantitative\"}, {\"field\": \"log2_bayes_factor\", \"format\": \",.4f\", \"title\": \"Match weight = log2(m/u)\", \"type\": \"quantitative\"}, {\"field\": \"prob\", \"format\": \".4f\", \"title\": \"Cumulative match probability\", \"type\": \"quantitative\"}, {\"field\": \"bayes_factor_description\", \"title\": \"Match weight description\", \"type\": \"nominal\"}], \"x\": {\"axis\": {\"grid\": true, \"labelAlign\": \"center\", \"labelAngle\": -20, \"labelExpr\": \"datum.value == 'Prior' || datum.value == 'Final score' ? '' : datum.value\", \"labelPadding\": 10, \"tickBand\": \"extent\", \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"axis\": {\"grid\": false, \"orient\": \"left\", \"title\": \"Match Weight\"}, \"field\": \"previous_sum\", \"type\": \"quantitative\"}, \"y2\": {\"field\": \"sum\"}}}, {\"mark\": {\"type\": \"text\", \"fontWeight\": \"bold\"}, \"encoding\": {\"color\": {\"value\": \"white\"}, \"text\": {\"condition\": {\"test\": \"abs(datum.log2_bayes_factor) > 1\", \"field\": \"log2_bayes_factor\", \"format\": \".2f\", \"type\": \"nominal\"}, \"value\": \"\"}, \"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"axis\": {\"orient\": \"left\"}, \"field\": \"center\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"baseline\": \"bottom\", \"dy\": -25, \"fontWeight\": \"bold\"}, \"encoding\": {\"color\": {\"value\": \"black\"}, \"text\": {\"field\": \"column_name\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"field\": \"sum_top\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"baseline\": \"bottom\", \"dy\": -13, \"fontSize\": 8}, \"encoding\": {\"color\": {\"value\": \"grey\"}, \"text\": {\"field\": \"value_l\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"field\": \"sum_top\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"baseline\": \"bottom\", \"dy\": -5, \"fontSize\": 8}, \"encoding\": {\"color\": {\"value\": \"grey\"}, \"text\": {\"field\": \"value_r\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"field\": \"sum_top\", \"type\": \"quantitative\"}}}]}, {\"mark\": {\"type\": \"rule\", \"color\": \"black\", \"strokeWidth\": 2, \"x2Offset\": 30, \"xOffset\": -30}, \"encoding\": {\"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"x2\": {\"field\": \"lead\"}, \"y\": {\"axis\": {\"labelExpr\": \"format(1 / (1 + pow(2, -1*datum.value)), '.2r')\", \"orient\": \"right\", \"title\": \"Probability\"}, \"field\": \"sum\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}}}], \"data\": {\"name\": \"data-507e36d68e0812e856afe0ad75edc0bc\"}, \"height\": 450, \"params\": [{\"name\": \"record_number\", \"bind\": {\"input\": \"range\", \"max\": 6, \"min\": 0, \"step\": 1}, \"value\": 0}], \"resolve\": {\"axis\": {\"y\": \"independent\"}}, \"title\": {\"text\": \"Match weights waterfall chart\", \"subtitle\": \"How each comparison contributes to the final match score\"}, \"transform\": [{\"filter\": \"(datum.record_number == record_number)\"}, {\"window\": [{\"op\": \"sum\", \"field\": \"log2_bayes_factor\", \"as\": \"sum\"}, {\"op\": \"lead\", \"field\": \"column_name\", \"as\": \"lead\"}], \"frame\": [null, 0]}, {\"calculate\": \"datum.column_name === \\\"Final score\\\" ? datum.sum - datum.log2_bayes_factor : datum.sum\", \"as\": \"sum\"}, {\"calculate\": \"datum.lead === null ? datum.column_name : datum.lead\", \"as\": \"lead\"}, {\"calculate\": \"datum.column_name === \\\"Final score\\\" || datum.column_name === \\\"Prior match weight\\\" ? 0 : datum.sum - datum.log2_bayes_factor\", \"as\": \"previous_sum\"}, {\"calculate\": \"datum.sum > datum.previous_sum ? datum.column_name : \\\"\\\"\", \"as\": \"top_label\"}, {\"calculate\": \"datum.sum < datum.previous_sum ? datum.column_name : \\\"\\\"\", \"as\": \"bottom_label\"}, {\"calculate\": \"datum.sum > datum.previous_sum ? datum.sum : datum.previous_sum\", \"as\": \"sum_top\"}, {\"calculate\": \"datum.sum < datum.previous_sum ? datum.sum : datum.previous_sum\", \"as\": \"sum_bottom\"}, {\"calculate\": \"(datum.sum + datum.previous_sum) / 2\", \"as\": \"center\"}, {\"calculate\": \"(datum.log2_bayes_factor > 0 ? \\\"+\\\" : \\\"\\\") + datum.log2_bayes_factor\", \"as\": \"text_log2_bayes_factor\"}, {\"calculate\": \"datum.sum < datum.previous_sum ? 4 : -4\", \"as\": \"dy\"}, {\"calculate\": \"datum.sum < datum.previous_sum ? \\\"top\\\" : \\\"bottom\\\"\", \"as\": \"baseline\"}, {\"calculate\": \"1. / (1 + pow(2, -1.*datum.sum))\", \"as\": \"prob\"}, {\"calculate\": \"0*datum.sum\", \"as\": \"zero\"}], \"width\": {\"step\": 75}, \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.9.3.json\", \"datasets\": {\"data-507e36d68e0812e856afe0ad75edc0bc\": [{\"column_name\": \"Prior\", \"label_for_charts\": \"Starting match weight (prior)\", \"sql_condition\": null, \"log2_bayes_factor\": -5.391889789559854, \"bayes_factor\": 0.023816582302252427, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 0, \"record_number\": 0}, {\"column_name\": \"first_name\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"first_name_l = first_name_r\", \"log2_bayes_factor\": 6.452385051922501, \"bayes_factor\": 87.57122888658395, \"comparison_vector_value\": 2, \"m_probability\": 0.5073501669215337, \"u_probability\": 0.0057935713975033705, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 87.57 times more likely to be a match\", \"value_l\": \"Robert\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 1, \"record_number\": 0}, {\"column_name\": \"tf_first_name\", \"label_for_charts\": \"Term freq adjustment on first_name with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"first_name_l = first_name_r\", \"log2_bayes_factor\": 0.6824108408369749, \"bayes_factor\": 1.6048192771084335, \"comparison_vector_value\": 2, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on first_name makes comparison 1.60 times more likely to be a match\", \"value_l\": \"Robert\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 2, \"record_number\": 0}, {\"column_name\": \"surname\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"surname_l = surname_r\", \"log2_bayes_factor\": 6.529599913880287, \"bayes_factor\": 92.38584465067325, \"comparison_vector_value\": 2, \"m_probability\": 0.4517645215191846, \"u_probability\": 0.004889975550122249, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 92.39 times more likely to be a match\", \"value_l\": \"Alan\", \"value_r\": \"Alan\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 3, \"record_number\": 0}, {\"column_name\": \"tf_surname\", \"label_for_charts\": \"Term freq adjustment on surname with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"surname_l = surname_r\", \"log2_bayes_factor\": 2.0017626086992597, \"bayes_factor\": 4.004889975550122, \"comparison_vector_value\": 2, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on surname makes comparison 4.00 times more likely to be a match\", \"value_l\": \"Alan\", \"value_r\": \"Alan\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 4, \"record_number\": 0}, {\"column_name\": \"dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 4.425772921275592, \"bayes_factor\": 21.492671620753597, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"1971-06-24\", \"value_r\": \"1971-05-24\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 5, \"record_number\": 0}, {\"column_name\": \"tf_dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 6, \"record_number\": 0}, {\"column_name\": \"city\", \"label_for_charts\": \"Null\", \"sql_condition\": \"city_l IS NULL OR city_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"London\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 7, \"record_number\": 0}, {\"column_name\": \"tf_city\", \"label_for_charts\": \"Null\", \"sql_condition\": \"city_l IS NULL OR city_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 8, \"record_number\": 0}, {\"column_name\": \"email\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"email_l = email_r\", \"log2_bayes_factor\": 8.04017554864013, \"bayes_factor\": 263.2291676754963, \"comparison_vector_value\": 1, \"m_probability\": 0.5774909200578013, \"u_probability\": 0.0021938713143283602, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 263.23 times more likely to be a match\", \"value_l\": \"robert255@smith.net\", \"value_r\": \"robert255@smith.net\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 9, \"record_number\": 0}, {\"column_name\": \"tf_email\", \"label_for_charts\": \"Term freq adjustment on email with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"email_l = email_r\", \"log2_bayes_factor\": 0.791576109567796, \"bayes_factor\": 1.730964467005076, \"comparison_vector_value\": 1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on email makes comparison 1.73 times more likely to be a match\", \"value_l\": \"robert255@smith.net\", \"value_r\": \"robert255@smith.net\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 10, \"record_number\": 0}, {\"column_name\": \"Final score\", \"label_for_charts\": \"Final score\", \"sql_condition\": null, \"log2_bayes_factor\": 23.531793205262687, \"bayes_factor\": 12127620.72557027, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 11, \"record_number\": 0}, {\"column_name\": \"Prior\", \"label_for_charts\": \"Starting match weight (prior)\", \"sql_condition\": null, \"log2_bayes_factor\": -5.391889789559854, \"bayes_factor\": 0.023816582302252427, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 0, \"record_number\": 1}, {\"column_name\": \"first_name\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"first_name_l = first_name_r\", \"log2_bayes_factor\": 6.452385051922501, \"bayes_factor\": 87.57122888658395, \"comparison_vector_value\": 2, \"m_probability\": 0.5073501669215337, \"u_probability\": 0.0057935713975033705, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 87.57 times more likely to be a match\", \"value_l\": \"Robert\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 1, \"record_number\": 1}, {\"column_name\": \"tf_first_name\", \"label_for_charts\": \"Term freq adjustment on first_name with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"first_name_l = first_name_r\", \"log2_bayes_factor\": 0.6824108408369749, \"bayes_factor\": 1.6048192771084335, \"comparison_vector_value\": 2, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on first_name makes comparison 1.60 times more likely to be a match\", \"value_l\": \"Robert\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 2, \"record_number\": 1}, {\"column_name\": \"surname\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(surname_l, surname_r) <= 2\", \"log2_bayes_factor\": 5.383523868172574, \"bayes_factor\": 41.74477904659683, \"comparison_vector_value\": 1, \"m_probability\": 0.3078165102205689, \"u_probability\": 0.007373772654946249, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match\", \"value_l\": \"Allen\", \"value_r\": \"Alan\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 3, \"record_number\": 1}, {\"column_name\": \"tf_surname\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(surname_l, surname_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3078165102205689, \"u_probability\": 0.007373772654946249, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 4, \"record_number\": 1}, {\"column_name\": \"dob\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"dob_l = dob_r\", \"log2_bayes_factor\": 7.858170603008739, \"bayes_factor\": 232.03049287476935, \"comparison_vector_value\": 2, \"m_probability\": 0.405530771330678, \"u_probability\": 0.0017477477477477479, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 232.03 times more likely to be a match\", \"value_l\": \"1971-05-24\", \"value_r\": \"1971-05-24\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 5, \"record_number\": 1}, {\"column_name\": \"tf_dob\", \"label_for_charts\": \"Term freq adjustment on dob with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"dob_l = dob_r\", \"log2_bayes_factor\": 0.805496975837022, \"bayes_factor\": 1.747747747747748, \"comparison_vector_value\": 2, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on dob makes comparison 1.75 times more likely to be a match\", \"value_l\": \"1971-05-24\", \"value_r\": \"1971-05-24\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 6, \"record_number\": 1}, {\"column_name\": \"city\", \"label_for_charts\": \"Null\", \"sql_condition\": \"city_l IS NULL OR city_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"London\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 7, \"record_number\": 1}, {\"column_name\": \"tf_city\", \"label_for_charts\": \"Null\", \"sql_condition\": \"city_l IS NULL OR city_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 8, \"record_number\": 1}, {\"column_name\": \"email\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -1.239777184635766, \"bayes_factor\": 0.4234380485302649, \"comparison_vector_value\": 0, \"m_probability\": 0.42250907994219916, \"u_probability\": 0.9978061286856716, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match\", \"value_l\": \"roberta25@smith.net\", \"value_r\": \"robert255@smith.net\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 9, \"record_number\": 1}, {\"column_name\": \"tf_email\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.42250907994219916, \"u_probability\": 0.9978061286856716, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 10, \"record_number\": 1}, {\"column_name\": \"Final score\", \"label_for_charts\": \"Final score\", \"sql_condition\": null, \"log2_bayes_factor\": 14.550320365582191, \"bayes_factor\": 23992.90732786014, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 11, \"record_number\": 1}, {\"column_name\": \"Prior\", \"label_for_charts\": \"Starting match weight (prior)\", \"sql_condition\": null, \"log2_bayes_factor\": -5.391889789559854, \"bayes_factor\": 0.023816582302252427, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 0, \"record_number\": 2}, {\"column_name\": \"first_name\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"first_name_l = first_name_r\", \"log2_bayes_factor\": 6.452385051922501, \"bayes_factor\": 87.57122888658395, \"comparison_vector_value\": 2, \"m_probability\": 0.5073501669215337, \"u_probability\": 0.0057935713975033705, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 87.57 times more likely to be a match\", \"value_l\": \"Robert\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 1, \"record_number\": 2}, {\"column_name\": \"tf_first_name\", \"label_for_charts\": \"Term freq adjustment on first_name with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"first_name_l = first_name_r\", \"log2_bayes_factor\": 0.6824108408369749, \"bayes_factor\": 1.6048192771084335, \"comparison_vector_value\": 2, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on first_name makes comparison 1.60 times more likely to be a match\", \"value_l\": \"Robert\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 2, \"record_number\": 2}, {\"column_name\": \"surname\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(surname_l, surname_r) <= 2\", \"log2_bayes_factor\": 5.383523868172574, \"bayes_factor\": 41.74477904659683, \"comparison_vector_value\": 1, \"m_probability\": 0.3078165102205689, \"u_probability\": 0.007373772654946249, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match\", \"value_l\": \"Alen\", \"value_r\": \"Alan\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 3, \"record_number\": 2}, {\"column_name\": \"tf_surname\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(surname_l, surname_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3078165102205689, \"u_probability\": 0.007373772654946249, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 4, \"record_number\": 2}, {\"column_name\": \"dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 4.425772921275592, \"bayes_factor\": 21.492671620753597, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"1971-06-24\", \"value_r\": \"1971-05-24\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 5, \"record_number\": 2}, {\"column_name\": \"tf_dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 6, \"record_number\": 2}, {\"column_name\": \"city\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -1.1635794871398053, \"bayes_factor\": 0.4464035832880252, \"comparison_vector_value\": 0, \"m_probability\": 0.4217855099035769, \"u_probability\": 0.9448524288198547, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match\", \"value_l\": \"Lonon\", \"value_r\": \"London\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 7, \"record_number\": 2}, {\"column_name\": \"tf_city\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.4217855099035769, \"u_probability\": 0.9448524288198547, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 8, \"record_number\": 2}, {\"column_name\": \"email\", \"label_for_charts\": \"Null\", \"sql_condition\": \"email_l IS NULL OR email_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"robert255@smith.net\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 9, \"record_number\": 2}, {\"column_name\": \"tf_email\", \"label_for_charts\": \"Null\", \"sql_condition\": \"email_l IS NULL OR email_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 10, \"record_number\": 2}, {\"column_name\": \"Final score\", \"label_for_charts\": \"Final score\", \"sql_condition\": null, \"log2_bayes_factor\": 10.388623405507984, \"bayes_factor\": 1340.5630931238354, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 11, \"record_number\": 2}, {\"column_name\": \"Prior\", \"label_for_charts\": \"Starting match weight (prior)\", \"sql_condition\": null, \"log2_bayes_factor\": -5.391889789559854, \"bayes_factor\": 0.023816582302252427, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 0, \"record_number\": 3}, {\"column_name\": \"first_name\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -2.1925340745596764, \"bayes_factor\": 0.21876683164040506, \"comparison_vector_value\": 0, \"m_probability\": 0.21528549148688833, \"u_probability\": 0.9840865266118626, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  4.57 times less likely to be a match\", \"value_l\": \"Rob\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 1, \"record_number\": 3}, {\"column_name\": \"tf_first_name\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.21528549148688833, \"u_probability\": 0.9840865266118626, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  4.57 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 2, \"record_number\": 3}, {\"column_name\": \"surname\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(surname_l, surname_r) <= 2\", \"log2_bayes_factor\": 5.383523868172574, \"bayes_factor\": 41.74477904659683, \"comparison_vector_value\": 1, \"m_probability\": 0.3078165102205689, \"u_probability\": 0.007373772654946249, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match\", \"value_l\": \"Allen\", \"value_r\": \"Alan\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 3, \"record_number\": 3}, {\"column_name\": \"tf_surname\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(surname_l, surname_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3078165102205689, \"u_probability\": 0.007373772654946249, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 4, \"record_number\": 3}, {\"column_name\": \"dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 4.425772921275592, \"bayes_factor\": 21.492671620753597, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"1971-06-24\", \"value_r\": \"1971-05-24\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 5, \"record_number\": 3}, {\"column_name\": \"tf_dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 6, \"record_number\": 3}, {\"column_name\": \"city\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"city_l = city_r\", \"log2_bayes_factor\": 3.3902355104306197, \"bayes_factor\": 10.484858675056154, \"comparison_vector_value\": 1, \"m_probability\": 0.5782144900964232, \"u_probability\": 0.0551475711801453, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 10.48 times more likely to be a match\", \"value_l\": \"London\", \"value_r\": \"London\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 7, \"record_number\": 3}, {\"column_name\": \"tf_city\", \"label_for_charts\": \"Term freq adjustment on city with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"city_l = city_r\", \"log2_bayes_factor\": -1.948075527570922, \"bayes_factor\": 0.2591617073379083, \"comparison_vector_value\": 1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on city makes comparison  3.86 times less likely to be a match\", \"value_l\": \"London\", \"value_r\": \"London\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 8, \"record_number\": 3}, {\"column_name\": \"email\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -1.239777184635766, \"bayes_factor\": 0.4234380485302649, \"comparison_vector_value\": 0, \"m_probability\": 0.42250907994219916, \"u_probability\": 0.9978061286856716, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match\", \"value_l\": \"roberta25@smith.net\", \"value_r\": \"robert255@smith.net\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 9, \"record_number\": 3}, {\"column_name\": \"tf_email\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.42250907994219916, \"u_probability\": 0.9978061286856716, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 10, \"record_number\": 3}, {\"column_name\": \"Final score\", \"label_for_charts\": \"Final score\", \"sql_condition\": null, \"log2_bayes_factor\": 2.427255723552568, \"bayes_factor\": 5.3786932873387086, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 11, \"record_number\": 3}, {\"column_name\": \"Prior\", \"label_for_charts\": \"Starting match weight (prior)\", \"sql_condition\": null, \"log2_bayes_factor\": -5.391889789559854, \"bayes_factor\": 0.023816582302252427, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 0, \"record_number\": 4}, {\"column_name\": \"first_name\", \"label_for_charts\": \"Null\", \"sql_condition\": \"first_name_l IS NULL OR first_name_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 1, \"record_number\": 4}, {\"column_name\": \"tf_first_name\", \"label_for_charts\": \"Null\", \"sql_condition\": \"first_name_l IS NULL OR first_name_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 2, \"record_number\": 4}, {\"column_name\": \"surname\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(surname_l, surname_r) <= 2\", \"log2_bayes_factor\": 5.383523868172574, \"bayes_factor\": 41.74477904659683, \"comparison_vector_value\": 1, \"m_probability\": 0.3078165102205689, \"u_probability\": 0.007373772654946249, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match\", \"value_l\": \"Dean\", \"value_r\": \"Alan\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 3, \"record_number\": 4}, {\"column_name\": \"tf_surname\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(surname_l, surname_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3078165102205689, \"u_probability\": 0.007373772654946249, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 41.74 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 4, \"record_number\": 4}, {\"column_name\": \"dob\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -2.114723717091652, \"bayes_factor\": 0.23088978993311773, \"comparison_vector_value\": 0, \"m_probability\": 0.22653362300553073, \"u_probability\": 0.9811331331331331, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match\", \"value_l\": \"2015-03-03\", \"value_r\": \"1971-05-24\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 5, \"record_number\": 4}, {\"column_name\": \"tf_dob\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.22653362300553073, \"u_probability\": 0.9811331331331331, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 6, \"record_number\": 4}, {\"column_name\": \"city\", \"label_for_charts\": \"Null\", \"sql_condition\": \"city_l IS NULL OR city_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"London\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 7, \"record_number\": 4}, {\"column_name\": \"tf_city\", \"label_for_charts\": \"Null\", \"sql_condition\": \"city_l IS NULL OR city_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 8, \"record_number\": 4}, {\"column_name\": \"email\", \"label_for_charts\": \"Null\", \"sql_condition\": \"email_l IS NULL OR email_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"robert255@smith.net\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 9, \"record_number\": 4}, {\"column_name\": \"tf_email\", \"label_for_charts\": \"Null\", \"sql_condition\": \"email_l IS NULL OR email_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 10, \"record_number\": 4}, {\"column_name\": \"Final score\", \"label_for_charts\": \"Final score\", \"sql_condition\": null, \"log2_bayes_factor\": -2.1230896384789317, \"bayes_factor\": 0.22955477728344212, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 11, \"record_number\": 4}, {\"column_name\": \"Prior\", \"label_for_charts\": \"Starting match weight (prior)\", \"sql_condition\": null, \"log2_bayes_factor\": -5.391889789559854, \"bayes_factor\": 0.023816582302252427, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 0, \"record_number\": 5}, {\"column_name\": \"first_name\", \"label_for_charts\": \"Null\", \"sql_condition\": \"first_name_l IS NULL OR first_name_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 1, \"record_number\": 5}, {\"column_name\": \"tf_first_name\", \"label_for_charts\": \"Null\", \"sql_condition\": \"first_name_l IS NULL OR first_name_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 2, \"record_number\": 5}, {\"column_name\": \"surname\", \"label_for_charts\": \"Null\", \"sql_condition\": \"surname_l IS NULL OR surname_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"Alan\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 3, \"record_number\": 5}, {\"column_name\": \"tf_surname\", \"label_for_charts\": \"Null\", \"sql_condition\": \"surname_l IS NULL OR surname_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 4, \"record_number\": 5}, {\"column_name\": \"dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 4.425772921275592, \"bayes_factor\": 21.492671620753597, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"1971-07-20\", \"value_r\": \"1971-05-24\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 5, \"record_number\": 5}, {\"column_name\": \"tf_dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 6, \"record_number\": 5}, {\"column_name\": \"city\", \"label_for_charts\": \"Null\", \"sql_condition\": \"city_l IS NULL OR city_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"London\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 7, \"record_number\": 5}, {\"column_name\": \"tf_city\", \"label_for_charts\": \"Null\", \"sql_condition\": \"city_l IS NULL OR city_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 8, \"record_number\": 5}, {\"column_name\": \"email\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -1.239777184635766, \"bayes_factor\": 0.4234380485302649, \"comparison_vector_value\": 0, \"m_probability\": 0.42250907994219916, \"u_probability\": 0.9978061286856716, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match\", \"value_l\": \"j.c@whige.wort\", \"value_r\": \"robert255@smith.net\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 9, \"record_number\": 5}, {\"column_name\": \"tf_email\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.42250907994219916, \"u_probability\": 0.9978061286856716, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 10, \"record_number\": 5}, {\"column_name\": \"Final score\", \"label_for_charts\": \"Final score\", \"sql_condition\": null, \"log2_bayes_factor\": -2.2058940529200273, \"bayes_factor\": 0.21675030776918294, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 11, \"record_number\": 5}, {\"column_name\": \"Prior\", \"label_for_charts\": \"Starting match weight (prior)\", \"sql_condition\": null, \"log2_bayes_factor\": -5.391889789559854, \"bayes_factor\": 0.023816582302252427, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 0, \"record_number\": 6}, {\"column_name\": \"first_name\", \"label_for_charts\": \"Null\", \"sql_condition\": \"first_name_l IS NULL OR first_name_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"None\", \"value_r\": \"Robert\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 1, \"record_number\": 6}, {\"column_name\": \"tf_first_name\", \"label_for_charts\": \"Null\", \"sql_condition\": \"first_name_l IS NULL OR first_name_r IS NULL\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": -1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"If comparison level is `null` then comparison is 1.00 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 2, \"record_number\": 6}, {\"column_name\": \"surname\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -2.03857513621085, \"bayes_factor\": 0.24340401379756268, \"comparison_vector_value\": 0, \"m_probability\": 0.24041896826024636, \"u_probability\": 0.9877362517949315, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  4.11 times less likely to be a match\", \"value_l\": \"Cox\", \"value_r\": \"Alan\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 3, \"record_number\": 6}, {\"column_name\": \"tf_surname\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.24041896826024636, \"u_probability\": 0.9877362517949315, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  4.11 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 4, \"record_number\": 6}, {\"column_name\": \"dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 4.425772921275592, \"bayes_factor\": 21.492671620753597, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"1971-07-20\", \"value_r\": \"1971-05-24\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 5, \"record_number\": 6}, {\"column_name\": \"tf_dob\", \"label_for_charts\": \"Levenstein <= 2\", \"sql_condition\": \"levenshtein(dob_l, dob_r) <= 2\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": 0.3679356056637918, \"u_probability\": 0.01711911911911912, \"bayes_factor_description\": \"If comparison level is `levenstein <= 2` then comparison is 21.49 times more likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 6, \"record_number\": 6}, {\"column_name\": \"city\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"city_l = city_r\", \"log2_bayes_factor\": 3.3902355104306197, \"bayes_factor\": 10.484858675056154, \"comparison_vector_value\": 1, \"m_probability\": 0.5782144900964232, \"u_probability\": 0.0551475711801453, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 10.48 times more likely to be a match\", \"value_l\": \"London\", \"value_r\": \"London\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 7, \"record_number\": 6}, {\"column_name\": \"tf_city\", \"label_for_charts\": \"Term freq adjustment on city with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"city_l = city_r\", \"log2_bayes_factor\": -1.948075527570922, \"bayes_factor\": 0.2591617073379083, \"comparison_vector_value\": 1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on city makes comparison  3.86 times less likely to be a match\", \"value_l\": \"London\", \"value_r\": \"London\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 8, \"record_number\": 6}, {\"column_name\": \"email\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -1.239777184635766, \"bayes_factor\": 0.4234380485302649, \"comparison_vector_value\": 0, \"m_probability\": 0.42250907994219916, \"u_probability\": 0.9978061286856716, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match\", \"value_l\": \"j.c@white.org\", \"value_r\": \"robert255@smith.net\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 9, \"record_number\": 6}, {\"column_name\": \"tf_email\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.42250907994219916, \"u_probability\": 0.9978061286856716, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.36 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 10, \"record_number\": 6}, {\"column_name\": \"Final score\", \"label_for_charts\": \"Final score\", \"sql_condition\": null, \"log2_bayes_factor\": -2.80230920627118, \"bayes_factor\": 0.14335764954196265, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 11, \"record_number\": 6}]}}, {\"mode\": \"vega-lite\"});\n</script>","text/plain":"alt.LayerChart(...)"},"metadata":{},"output_type":"display_data"}],"tabbable":null,"tooltip":null}},"02e8a279eb01454f85ae769092f9b10b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"VBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_7184054b9ca545d1bca3f7753d67e3fa","IPY_MODEL_0357a182f7e94f7080da2b0bf1d20019","IPY_MODEL_16662606ae6a41079f351f559e88663e","IPY_MODEL_3536a0c72eb94af6a602655d41d5a8bd","IPY_MODEL_ca14ad662dd642d4b46f294bead0f2ca","IPY_MODEL_0e3bc354bd25491b8415c2781a9bffcd"],"layout":"IPY_MODEL_819220ee9a2a47aebaa6d6a90b28db22","tabbable":null,"tooltip":null}},"0357a182f7e94f7080da2b0bf1d20019":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"first_name","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_837184aa3e114163bf96940fcf0dec81","placeholder":"​","style":"IPY_MODEL_954873a0e5f6416bbb63495823d108a6","tabbable":null,"tooltip":null,"value":"Lucas"}},"07c347e4870b4e63b9634b95b3aaae8a":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"first_name","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_d2ccb7409a974888ae233cac95aa39a0","placeholder":"​","style":"IPY_MODEL_915ea392789941ce86058012574cf17b","tabbable":null,"tooltip":null,"value":"Robert"}},"0843d19a3ca84bf4b39ad6bf666f3880":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0af079938fba4a8baf8a22deb7c5a783":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0bc2cdd29423494390f2fd3ec377d2bd":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"email","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_a857f849682f4007907db769e1d75aaf","placeholder":"​","style":"IPY_MODEL_a66ed0bd1b494a08b73ae7e59313c199","tabbable":null,"tooltip":null,"value":"robert255@smith.net"}},"0e3bc354bd25491b8415c2781a9bffcd":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"city","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_e0d4deb5151a4ef0896f1c412981761a","placeholder":"​","style":"IPY_MODEL_8e9512d971a3454d8d57586c701fcc14","tabbable":null,"tooltip":null,"value":"Machester"}},"13f94d076397449694973b221afef5a3":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"16662606ae6a41079f351f559e88663e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"surname","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_abed0fce68464e60808b3c889e2e0abe","placeholder":"​","style":"IPY_MODEL_c1007a9708cd49fbb9a1ab6228d48118","tabbable":null,"tooltip":null,"value":"Smith"}},"1bf00e416fa6484fb415963b3962aa43":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1d29979ad5b54fc6a3d93575ae6ca3b2":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"20f5e31c3224413d81589c67aaaf69c2":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"first_name","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_6988dd2160d441caba0606015b7e1b39","placeholder":"​","style":"IPY_MODEL_3e69b9f579cd48d198750cdfc25109a3","tabbable":null,"tooltip":null,"value":"Lucas"}},"2bd36b04c039478c9db999de2a63b410":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"VBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_aa10f02d70ba469b9b4cf9747dacb267","IPY_MODEL_20f5e31c3224413d81589c67aaaf69c2","IPY_MODEL_eae494c4eff54eb1ac5d0d14f1b28f8c","IPY_MODEL_6a86100745f84059bb2d77bdc80065c4","IPY_MODEL_deb78f8178d34b4ca0be39539226eba6","IPY_MODEL_5b59d0b57440401bb46fcc29f3ffb8c9"],"layout":"IPY_MODEL_9ae8006326fe431d971668de3c81663c","tabbable":null,"tooltip":null}},"2c4d375313bc4f10916e147c5da26236":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3079088e2c0645c2a535f14812b22004":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"3536a0c72eb94af6a602655d41d5a8bd":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"dob","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_1bf00e416fa6484fb415963b3962aa43","placeholder":"​","style":"IPY_MODEL_4b77f28ca5d54123a9add585b635257e","tabbable":null,"tooltip":null,"value":"1983-02-12"}},"3e69b9f579cd48d198750cdfc25109a3":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"41e54bdebbe44ba1a7656d4ffe18bba1":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"4b77f28ca5d54123a9add585b635257e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"52aba204479746d5848fbfd32309aba5":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"5a58db9adf6e4880ac8ad1f246ff6e59":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"5b59d0b57440401bb46fcc29f3ffb8c9":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"city","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_13f94d076397449694973b221afef5a3","placeholder":"​","style":"IPY_MODEL_5a58db9adf6e4880ac8ad1f246ff6e59","tabbable":null,"tooltip":null,"value":"London"}},"5c1fe4719fdd4392a31a00957b8f7210":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6988dd2160d441caba0606015b7e1b39":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6a86100745f84059bb2d77bdc80065c4":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"dob","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_2c4d375313bc4f10916e147c5da26236","placeholder":"​","style":"IPY_MODEL_3079088e2c0645c2a535f14812b22004","tabbable":null,"tooltip":null,"value":"1984-01-02"}},"7184054b9ca545d1bca3f7753d67e3fa":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"unique_id","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_0843d19a3ca84bf4b39ad6bf666f3880","placeholder":"​","style":"IPY_MODEL_c3d1cdf0616a474d94ceb148b9769d2e","tabbable":null,"tooltip":null,"value":"2"}},"748a6427571f47e7b4d2363453063d77":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"758a5f37482849bc8b85e05f8738d10a":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"79f05bd6a30c4ffe9233af8297af8192":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"819220ee9a2a47aebaa6d6a90b28db22":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"81c9d17a00994a17a54720a63a7b755d":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"837184aa3e114163bf96940fcf0dec81":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8545cee6c5444c7aa0d47a268026fcb7":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"VBoxModel","state":{"_dom_classes":["widget-interact"],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_07c347e4870b4e63b9634b95b3aaae8a","IPY_MODEL_ce4ca2c35bb34821a26f58268e68badc","IPY_MODEL_acb163b6941248649eaa83c0180f8901","IPY_MODEL_bd490f5b5930420ebdcf95bacb85ac24","IPY_MODEL_0bc2cdd29423494390f2fd3ec377d2bd","IPY_MODEL_014274444095416d91fefd10139b148c"],"layout":"IPY_MODEL_79f05bd6a30c4ffe9233af8297af8192","tabbable":null,"tooltip":null}},"8e9512d971a3454d8d57586c701fcc14":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"915ea392789941ce86058012574cf17b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"954873a0e5f6416bbb63495823d108a6":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"9ae8006326fe431d971668de3c81663c":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a66ed0bd1b494a08b73ae7e59313c199":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"a827c85383da4c13927eadd5b4768cf3":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"a857f849682f4007907db769e1d75aaf":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aa10f02d70ba469b9b4cf9747dacb267":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"unique_id","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_adb9a0b8932d4f7887164d02e4e46f9d","placeholder":"​","style":"IPY_MODEL_b6baea8a2e31493a80aa253663dcbc48","tabbable":null,"tooltip":null,"value":"1"}},"abed0fce68464e60808b3c889e2e0abe":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"acb163b6941248649eaa83c0180f8901":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"dob","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_f672b44b2b9a4a43ab24a09e0a02a499","placeholder":"​","style":"IPY_MODEL_41e54bdebbe44ba1a7656d4ffe18bba1","tabbable":null,"tooltip":null,"value":"1971-05-24"}},"adb9a0b8932d4f7887164d02e4e46f9d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b6baea8a2e31493a80aa253663dcbc48":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"bd490f5b5930420ebdcf95bacb85ac24":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"city","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_748a6427571f47e7b4d2363453063d77","placeholder":"​","style":"IPY_MODEL_bf0b9712bfde438b98b661ba4d3f0d4f","tabbable":null,"tooltip":null,"value":"London"}},"bf0b9712bfde438b98b661ba4d3f0d4f":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"c1007a9708cd49fbb9a1ab6228d48118":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"c3d1cdf0616a474d94ceb148b9769d2e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"c47b5273ae244bf5b4ee85b683479e87":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/output","_model_module_version":"1.0.0","_model_name":"OutputModel","_view_count":null,"_view_module":"@jupyter-widgets/output","_view_module_version":"1.0.0","_view_name":"OutputView","layout":"IPY_MODEL_cfabc6dafc5946b696d9813163c39992","msg_id":"","outputs":[{"data":{"text/html":"\n<style>\n  #altair-viz-ff06456640be43bba1260fdb6cb32512.vega-embed {\n    width: 100%;\n    display: flex;\n  }\n\n  #altair-viz-ff06456640be43bba1260fdb6cb32512.vega-embed details,\n  #altair-viz-ff06456640be43bba1260fdb6cb32512.vega-embed details summary {\n    position: relative;\n  }\n</style>\n<div id="\&quot;altair-viz-ff06456640be43bba1260fdb6cb32512\&quot;"></div>\n<script type="\&quot;text/javascript\&quot;">\n  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n  (function(spec, embedOpt){\n    let outputDiv = document.currentScript.previousElementSibling;\n    if (outputDiv.id !== \"altair-viz-ff06456640be43bba1260fdb6cb32512\") {\n      outputDiv = document.getElementById(\"altair-viz-ff06456640be43bba1260fdb6cb32512\");\n    }\n    const paths = {\n      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@5?noext\",\n      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@5.16.3?noext\",\n      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@6?noext\",\n    };\n\n    function maybeLoadScript(lib, version) {\n      var key = `${lib.replace(\"-\", \"\")}_version`;\n      return (VEGA_DEBUG[key] == version) ?\n        Promise.resolve(paths[lib]) :\n        new Promise(function(resolve, reject) {\n          var s = document.createElement('script');\n          document.getElementsByTagName(\"head\")[0].appendChild(s);\n          s.async = true;\n          s.onload = () => {\n            VEGA_DEBUG[key] = version;\n            return resolve(paths[lib]);\n          };\n          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n          s.src = paths[lib];\n        });\n    }\n\n    function showError(err) {\n      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n      throw err;\n    }\n\n    function displayChart(vegaEmbed) {\n      vegaEmbed(outputDiv, spec, embedOpt)\n        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n    }\n\n    if(typeof define === \"function\" && define.amd) {\n      requirejs.config({paths});\n      require([\"vega-embed\"], displayChart, err => showError(`Error loading script: ${err.message}`));\n    } else {\n      maybeLoadScript(\"vega\", \"5\")\n        .then(() => maybeLoadScript(\"vega-lite\", \"5.16.3\"))\n        .then(() => maybeLoadScript(\"vega-embed\", \"6\"))\n        .catch(showError)\n        .then(() => displayChart(vegaEmbed));\n    }\n  })({\"config\": {\"view\": {\"continuousWidth\": 400, \"continuousHeight\": 300}}, \"layer\": [{\"layer\": [{\"mark\": \"rule\", \"encoding\": {\"color\": {\"value\": \"black\"}, \"size\": {\"value\": 0.5}, \"y\": {\"field\": \"zero\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"bar\", \"width\": 60}, \"encoding\": {\"color\": {\"condition\": {\"test\": \"(datum.log2_bayes_factor < 0)\", \"value\": \"red\"}, \"value\": \"green\"}, \"opacity\": {\"condition\": {\"test\": \"datum.column_name == 'Prior match weight' || datum.column_name == 'Final score'\", \"value\": 1}, \"value\": 0.5}, \"tooltip\": [{\"field\": \"column_name\", \"title\": \"Comparison column\", \"type\": \"nominal\"}, {\"field\": \"value_l\", \"title\": \"Value (L)\", \"type\": \"nominal\"}, {\"field\": \"value_r\", \"title\": \"Value (R)\", \"type\": \"nominal\"}, {\"field\": \"label_for_charts\", \"title\": \"Label\", \"type\": \"ordinal\"}, {\"field\": \"sql_condition\", \"title\": \"SQL condition\", \"type\": \"nominal\"}, {\"field\": \"comparison_vector_value\", \"title\": \"Comparison vector value\", \"type\": \"nominal\"}, {\"field\": \"bayes_factor\", \"format\": \",.4f\", \"title\": \"Bayes factor = m/u\", \"type\": \"quantitative\"}, {\"field\": \"log2_bayes_factor\", \"format\": \",.4f\", \"title\": \"Match weight = log2(m/u)\", \"type\": \"quantitative\"}, {\"field\": \"prob\", \"format\": \".4f\", \"title\": \"Cumulative match probability\", \"type\": \"quantitative\"}, {\"field\": \"bayes_factor_description\", \"title\": \"Match weight description\", \"type\": \"nominal\"}], \"x\": {\"axis\": {\"grid\": true, \"labelAlign\": \"center\", \"labelAngle\": -20, \"labelExpr\": \"datum.value == 'Prior' || datum.value == 'Final score' ? '' : datum.value\", \"labelPadding\": 10, \"tickBand\": \"extent\", \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"axis\": {\"grid\": false, \"orient\": \"left\", \"title\": \"Match Weight\"}, \"field\": \"previous_sum\", \"type\": \"quantitative\"}, \"y2\": {\"field\": \"sum\"}}}, {\"mark\": {\"type\": \"text\", \"fontWeight\": \"bold\"}, \"encoding\": {\"color\": {\"value\": \"white\"}, \"text\": {\"condition\": {\"test\": \"abs(datum.log2_bayes_factor) > 1\", \"field\": \"log2_bayes_factor\", \"format\": \".2f\", \"type\": \"nominal\"}, \"value\": \"\"}, \"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"axis\": {\"orient\": \"left\"}, \"field\": \"center\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"baseline\": \"bottom\", \"dy\": -25, \"fontWeight\": \"bold\"}, \"encoding\": {\"color\": {\"value\": \"black\"}, \"text\": {\"field\": \"column_name\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"field\": \"sum_top\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"baseline\": \"bottom\", \"dy\": -13, \"fontSize\": 8}, \"encoding\": {\"color\": {\"value\": \"grey\"}, \"text\": {\"field\": \"value_l\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"field\": \"sum_top\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"baseline\": \"bottom\", \"dy\": -5, \"fontSize\": 8}, \"encoding\": {\"color\": {\"value\": \"grey\"}, \"text\": {\"field\": \"value_r\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"y\": {\"field\": \"sum_top\", \"type\": \"quantitative\"}}}]}, {\"mark\": {\"type\": \"rule\", \"color\": \"black\", \"strokeWidth\": 2, \"x2Offset\": 30, \"xOffset\": -30}, \"encoding\": {\"x\": {\"axis\": {\"labelAngle\": -20, \"title\": \"Column\"}, \"field\": \"column_name\", \"sort\": {\"field\": \"bar_sort_order\", \"order\": \"ascending\"}, \"type\": \"nominal\"}, \"x2\": {\"field\": \"lead\"}, \"y\": {\"axis\": {\"labelExpr\": \"format(1 / (1 + pow(2, -1*datum.value)), '.2r')\", \"orient\": \"right\", \"title\": \"Probability\"}, \"field\": \"sum\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}}}], \"data\": {\"name\": \"data-cdd06dafae6b5312251e8edf2b87eed4\"}, \"height\": 450, \"params\": [{\"name\": \"record_number\", \"bind\": {\"input\": \"range\", \"max\": 0, \"min\": 0, \"step\": 1}, \"value\": 0}], \"resolve\": {\"axis\": {\"y\": \"independent\"}}, \"title\": {\"text\": \"Match weights waterfall chart\", \"subtitle\": \"How each comparison contributes to the final match score\"}, \"transform\": [{\"filter\": \"(datum.record_number == record_number)\"}, {\"window\": [{\"op\": \"sum\", \"field\": \"log2_bayes_factor\", \"as\": \"sum\"}, {\"op\": \"lead\", \"field\": \"column_name\", \"as\": \"lead\"}], \"frame\": [null, 0]}, {\"calculate\": \"datum.column_name === \\\"Final score\\\" ? datum.sum - datum.log2_bayes_factor : datum.sum\", \"as\": \"sum\"}, {\"calculate\": \"datum.lead === null ? datum.column_name : datum.lead\", \"as\": \"lead\"}, {\"calculate\": \"datum.column_name === \\\"Final score\\\" || datum.column_name === \\\"Prior match weight\\\" ? 0 : datum.sum - datum.log2_bayes_factor\", \"as\": \"previous_sum\"}, {\"calculate\": \"datum.sum > datum.previous_sum ? datum.column_name : \\\"\\\"\", \"as\": \"top_label\"}, {\"calculate\": \"datum.sum < datum.previous_sum ? datum.column_name : \\\"\\\"\", \"as\": \"bottom_label\"}, {\"calculate\": \"datum.sum > datum.previous_sum ? datum.sum : datum.previous_sum\", \"as\": \"sum_top\"}, {\"calculate\": \"datum.sum < datum.previous_sum ? datum.sum : datum.previous_sum\", \"as\": \"sum_bottom\"}, {\"calculate\": \"(datum.sum + datum.previous_sum) / 2\", \"as\": \"center\"}, {\"calculate\": \"(datum.log2_bayes_factor > 0 ? \\\"+\\\" : \\\"\\\") + datum.log2_bayes_factor\", \"as\": \"text_log2_bayes_factor\"}, {\"calculate\": \"datum.sum < datum.previous_sum ? 4 : -4\", \"as\": \"dy\"}, {\"calculate\": \"datum.sum < datum.previous_sum ? \\\"top\\\" : \\\"bottom\\\"\", \"as\": \"baseline\"}, {\"calculate\": \"1. / (1 + pow(2, -1.*datum.sum))\", \"as\": \"prob\"}, {\"calculate\": \"0*datum.sum\", \"as\": \"zero\"}], \"width\": {\"step\": 75}, \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.9.3.json\", \"datasets\": {\"data-cdd06dafae6b5312251e8edf2b87eed4\": [{\"column_name\": \"Prior\", \"label_for_charts\": \"Starting match weight (prior)\", \"sql_condition\": null, \"log2_bayes_factor\": -5.391889789559854, \"bayes_factor\": 0.023816582302252427, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 0, \"record_number\": 0}, {\"column_name\": \"first_name\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"first_name_l = first_name_r\", \"log2_bayes_factor\": 6.452385051922501, \"bayes_factor\": 87.57122888658395, \"comparison_vector_value\": 2, \"m_probability\": 0.5073501669215337, \"u_probability\": 0.0057935713975033705, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 87.57 times more likely to be a match\", \"value_l\": \"Lucas\", \"value_r\": \"Lucas\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 1, \"record_number\": 0}, {\"column_name\": \"tf_first_name\", \"label_for_charts\": \"Term freq adjustment on first_name with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"first_name_l = first_name_r\", \"log2_bayes_factor\": 2.267373341558131, \"bayes_factor\": 4.814457831325301, \"comparison_vector_value\": 2, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on first_name makes comparison 4.81 times more likely to be a match\", \"value_l\": \"Lucas\", \"value_r\": \"Lucas\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 2, \"record_number\": 0}, {\"column_name\": \"surname\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"surname_l = surname_r\", \"log2_bayes_factor\": 6.529599913880287, \"bayes_factor\": 92.38584465067325, \"comparison_vector_value\": 2, \"m_probability\": 0.4517645215191846, \"u_probability\": 0.004889975550122249, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 92.39 times more likely to be a match\", \"value_l\": \"Smith\", \"value_r\": \"Smith\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 3, \"record_number\": 0}, {\"column_name\": \"tf_surname\", \"label_for_charts\": \"Term freq adjustment on surname with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"surname_l = surname_r\", \"log2_bayes_factor\": -1.4576690099380376, \"bayes_factor\": 0.3640809068681929, \"comparison_vector_value\": 2, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on surname makes comparison  2.75 times less likely to be a match\", \"value_l\": \"Smith\", \"value_r\": \"Smith\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 4, \"record_number\": 0}, {\"column_name\": \"dob\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -2.114723717091652, \"bayes_factor\": 0.23088978993311773, \"comparison_vector_value\": 0, \"m_probability\": 0.22653362300553073, \"u_probability\": 0.9811331331331331, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match\", \"value_l\": \"1984-01-02\", \"value_r\": \"1983-02-12\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 5, \"record_number\": 0}, {\"column_name\": \"tf_dob\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.22653362300553073, \"u_probability\": 0.9811331331331331, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  4.33 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 6, \"record_number\": 0}, {\"column_name\": \"city\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": -1.1635794871398053, \"bayes_factor\": 0.4464035832880252, \"comparison_vector_value\": 0, \"m_probability\": 0.4217855099035769, \"u_probability\": 0.9448524288198547, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match\", \"value_l\": \"London\", \"value_r\": \"Machester\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 7, \"record_number\": 0}, {\"column_name\": \"tf_city\", \"label_for_charts\": \"All other comparisons\", \"sql_condition\": \"ELSE\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 0, \"m_probability\": 0.4217855099035769, \"u_probability\": 0.9448524288198547, \"bayes_factor_description\": \"If comparison level is `all other comparisons` then comparison is  2.24 times less likely to be a match\", \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 8, \"record_number\": 0}, {\"column_name\": \"email\", \"label_for_charts\": \"exact_match\", \"sql_condition\": \"email_l = email_r\", \"log2_bayes_factor\": 8.04017554864013, \"bayes_factor\": 263.2291676754963, \"comparison_vector_value\": 1, \"m_probability\": 0.5774909200578013, \"u_probability\": 0.0021938713143283602, \"bayes_factor_description\": \"If comparison level is `exact_match` then comparison is 263.23 times more likely to be a match\", \"value_l\": \"lucas.smith@hotmail.com\", \"value_r\": \"lucas.smith@hotmail.com\", \"term_frequency_adjustment\": false, \"bar_sort_order\": 9, \"record_number\": 0}, {\"column_name\": \"tf_email\", \"label_for_charts\": \"Term freq adjustment on email with weight {cl.tf_adjustment_weight}\", \"sql_condition\": \"email_l = email_r\", \"log2_bayes_factor\": 0.0, \"bayes_factor\": 1.0, \"comparison_vector_value\": 1, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": \"Term frequency adjustment on email makes comparison 1.00 times more likely to be a match\", \"value_l\": \"lucas.smith@hotmail.com\", \"value_r\": \"lucas.smith@hotmail.com\", \"term_frequency_adjustment\": true, \"bar_sort_order\": 10, \"record_number\": 0}, {\"column_name\": \"Final score\", \"label_for_charts\": \"Final score\", \"sql_condition\": null, \"log2_bayes_factor\": 13.1616718522717, \"bayes_factor\": 9163.429029878096, \"comparison_vector_value\": null, \"m_probability\": null, \"u_probability\": null, \"bayes_factor_description\": null, \"value_l\": \"\", \"value_r\": \"\", \"term_frequency_adjustment\": null, \"bar_sort_order\": 11, \"record_number\": 0}]}}, {\"mode\": \"vega-lite\"});\n</script>","text/plain":"alt.LayerChart(...)"},"metadata":{},"output_type":"display_data"}],"tabbable":null,"tooltip":null}},"ca14ad662dd642d4b46f294bead0f2ca":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"email","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_1d29979ad5b54fc6a3d93575ae6ca3b2","placeholder":"​","style":"IPY_MODEL_cf6e618b05c34bdaa3f4e6cd269c9cad","tabbable":null,"tooltip":null,"value":"lucas.smith@hotmail.com"}},"ca611417070848fa8244b01835c24563":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2bd36b04c039478c9db999de2a63b410","IPY_MODEL_02e8a279eb01454f85ae769092f9b10b"],"layout":"IPY_MODEL_0af079938fba4a8baf8a22deb7c5a783","tabbable":null,"tooltip":null}},"ce4ca2c35bb34821a26f58268e68badc":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"surname","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_ebbbcee950514b9e8397b1b4b4666157","placeholder":"​","style":"IPY_MODEL_52aba204479746d5848fbfd32309aba5","tabbable":null,"tooltip":null,"value":"Alan"}},"cf6e618b05c34bdaa3f4e6cd269c9cad":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"cfabc6dafc5946b696d9813163c39992":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d2ccb7409a974888ae233cac95aa39a0":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dbecc9c029184e27964189e6e9c569a0":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"deb78f8178d34b4ca0be39539226eba6":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"email","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_5c1fe4719fdd4392a31a00957b8f7210","placeholder":"​","style":"IPY_MODEL_81c9d17a00994a17a54720a63a7b755d","tabbable":null,"tooltip":null,"value":"lucas.smith@hotmail.com"}},"e0d4deb5151a4ef0896f1c412981761a":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eae494c4eff54eb1ac5d0d14f1b28f8c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"surname","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_758a5f37482849bc8b85e05f8738d10a","placeholder":"​","style":"IPY_MODEL_a827c85383da4c13927eadd5b4768cf3","tabbable":null,"tooltip":null,"value":"Smith"}},"ebbbcee950514b9e8397b1b4b4666157":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f672b44b2b9a4a43ab24a09e0a02a499":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}}},"version_major":2,"version_minor":0}

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>